!query
declare
    p_office_code number := ?;
    p_object_id_1 number := ?;
    p_object_id number := ?;
    p_office_name varchar2(100) := ?;
    p_org_symbol varchar2(8) := ?;
    p_sdo_gtype number := ?;
    p_sdo_srid number :=?;
    p_sdo_element_info_text str_tab_t := cwms_util.split_text(?,',');    
    l_sdo_element_info sdo_elem_info_array := sdo_elem_info_array();
    l_sdo_point sdo_point_type := sdo_point_type(NULL,NULL,NULL);  
    l_sdo_geom SDO_geometry;
begin    
    l_sdo_element_info.extend(p_sdo_element_info_text.count);    

    for e in 1..p_sdo_element_info_text.count loop
        l_sdo_element_info(e) := to_number(p_sdo_element_info_text(e));
    end loop;

    l_sdo_geom := SDO_geometry (
                    p_sdo_gtype, p_sdo_srid,
                    sdo_point_type(
                        l_sdo_element_info(1),
                        l_sdo_element_info(2),
                        l_sdo_element_info(3)
                    ),
                    null,
                    NULL
                );
    MERGE into cwms_20.CWMS_OFFICES_GEOLOC ad
        USING dual
        ON (ad.office_code = p_office_code)
        WHEN MATCHED then
            update set
                ad.objectid_1 = p_object_id_1,
                ad.objectid = p_object_id,
                ad.office_nam = p_office_name,
                ad.org_symbol = p_org_symbol,
                ad.shape = l_sdo_geom
        WHEN NOT MATCHED then
            insert( office_code, objectid_1,objectid, office_nam, org_symbol, shape)
            values( p_office_code,
                    p_object_id_1,
                    p_object_id,
                    p_office_name,
                    p_org_symbol,
                    l_sdo_geom
                )
;
end;
!endquery
!description
:office_code (?<current>[0-9]*),(?<remains>.*) int
:object_id_1 (?<current>^[0-9]*),(?<remains>.*) int
:object_id (?<current>^[0-9]*),(?<remains>.*) int
:office_name ("?)(?<current>.*?)\1,(?<remains>.*) string
:org_symbol ("?)(?<current>[a-zA-Z]*)\1,(?<remains>.*) string
:sdo_gtype (?<current>^[0-9]*),(?<remains>.*) int
:sdo_srid (?<current>^[0-9]*),(?<remains>.*) int
:sdo_element_info_array (?<blank>^,$)|(?<current>[0-9]{4},[-0-9.]*,[-0-9.]*)(?:,(?<remains>.*))|(?<all>^.*$) clob
!enddescription
!data
 39,38,38,"US Army Engineer District, Mobile","CESAM",2001,8265,-88.0447520001041,30.6911429997505,,
 40,39,39,"US Army Engineer District, Savannah","CESAS",2001,8265,-81.0937890001616,32.0773369997037,,
 41,40,40,"US Army Engineer District, Wilmington","CESAW",2001,8265,-77.9021980004367,34.2393570002263,,
 42,41,41,"US Army Engineer Division, South Pacific","CESPD",2001,8265,-122.397535000439,37.7921280004078,,
 43,42,42,"US Army Engineer District, Albuquerque","CESPA",2001,8265,-106.594784999627,35.1512290000192,,
 45,43,43,"US Army Engineer District, Los Angeles","CESPL",2001,8265,-118.259330999625,34.0501629998235,,
 44,44,44,"US Army Engineer District, Sacramento","CESPK",2001,8265,-121.488911000242,38.5791290001042,,
 46,45,45,"US Army Engineer District, San Francisco","CESPN",2001,8265,-122.397535000439,37.7921280004078,,
 47,46,46,"US Army Engineer Division, SouthWestern","CESWD",2001,8265,-96.80277900025,32.7791219996814,,
 48,47,47,"US Army Engineer District, Fort Worth","CESWF",2001,8265,-97.3320540002912,32.7512969998576,,
 49,48,48,"US Army Engineer District, Galveston","CESWG",2001,8265,-94.7822960003595,29.3093369998036,,
 50,49,49,"US Army Engineer District, Little Rock","CESWL",2001,8265,-92.2783200000673,34.7452340004497,,
 51,50,50,"US Army Engineer Distirct, Tulsa","CESWT",2001,8265,-95.8644489998209,36.1387839996827,,
 64,57,57,"US Army Humphreys Engineer Center Support Activity","CEHEC",2001,8265,-77.1424720003819,38.7487340000749,,
 2,3,3,"US Army Engineer Division, Great Lakes and Ohio River","CELRD",2001,8265,-84.5097799996466,39.1023699997766,,
 6,5,5,"US Army Engineer District, Buffalo","CELRB",2001,8265,-78.9014069997326,42.9326689999752,,
 4,6,6,"US Army Engineer District, Chicago","CELRC",2001,8265,-87.6319959999148,41.8783810003837,,
 5,7,7,"US Army Engineer District, Detroit","CELRE",2001,8265,-83.0988389997194,42.3000390001007,,
 8,8,8,"US Army Engineer District, Huntington","CELRH",2001,8265,-82.4449849995574,38.4191380001195,,
 9,9,9,"US Army Engineer District, Louisville","CELRL",2001,8265,-85.7613009998406,38.2488229997825,,
 10,10,10,"US Army Engineer District, Nashville","CELRN",2001,8265,-86.7830750001105,36.1581479996314,,
 11,11,11,"US Army Engineer District, Pittsburgh","CELRP",2001,8265,-79.9950739995648,40.443662000202,,
 12,12,12,"US Army Engineer Division, Mississippi Valley","CEMVD",2001,8265,-90.8813149997868,32.3489779998357,,
 14,13,13,"US Army Engineer District, Memphis","CEMVM",2001,8265,-90.0511950000486,35.1496039997257,,
 15,14,14,"US Army Engineer District, New Orleans","CEMVN",2001,8265,-90.1336170004236,29.9339149997783,,
 17,15,15,"US Army Engineer District, Rock Island","CEMVR",2001,8265,-90.5410000001493,41.5161000004156,,
 18,16,16,"US Army Engineer District, St. Louis","CEMVS",2001,8265,-90.1999649996844,38.6241640003692,,
 16,17,17,"US Army Engineer District, St. Paul","CEMVP",2001,8265,-93.0883769999979,44.9484760000682,,
 13,18,18,"US Army Engineer District, Vicksburg","CEMVK",2001,8265,-90.8554110004167,32.3453709998726,,
 19,19,19,"US Army Engineer Division, North Atlantic","CENAD",2001,8265,-74.0288000002192,40.617199999881,,
 20,20,20,"US Army Engineer District, Baltimore and Supervisor of Baltimore","CENAB",2001,8265,-76.6195859999933,39.2888300000054,,
 22,21,21,"US Army Engineer District, New York and Supervisor of New York Ha","CENAN",2001,8265,-74.0031350001794,40.7148510001744,,
 23,22,22,"US Army Engineer District, Norfolk and Supervisor of Norfolk Harb","CENAO",2001,8265,-76.3046849996124,36.8558829999014,,
 24,23,23,"US Army Engineer District, Philadelphia","CENAP",2001,8265,-75.1622679999676,39.9531889998734,,
 21,24,24,"US Army Engineer District, New England","CENAE",2001,8265,-71.2991449996413,42.4627719997289,,
 25,25,25,"US Army Engineer Division, Northwestern Division","CENWD",2001,8265,-122.678206999753,45.5245730000448,,
 31,27,27,"US Army Engineer District, Kansas City","CENWK",2001,8265,-94.5864679997977,39.0995950004099,,
 32,28,28,"US Army Engineer District, Omaha","CENWO",2001,8265,-95.9359799997765,41.2596340004097,,
 27,29,29,"US Army Engineer District, Portland","CENWP",2001,8265,-122.672349000306,45.5201520003155,,
 28,30,30,"US Army Engineer District, Seattle","CENWS",2001,8265,-122.339541999763,47.5609429996206,,
 29,31,31,"US Army Engineer District, Walla Walla","CENWW",2001,8265,-118.342159999884,46.0676750001021,,
 33,32,32,"US Army Engineer Division, Pacific Ocean","CEPOD",2001,8265,-157.889692000385,21.3393359998574,,
 34,33,33,"US Army Engineer District, Alaska","CEPOA",2001,8265,-149.846757999681,61.228445999784,,
 35,34,34,"US Army Engineer District, Honolulu","CEPOH",2001,8265,-157.889692000385,21.3392999999959,,
 36,35,35,"US Army Engineer Division, South Atlantic","CESAD",2001,8265,-84.3928950000036,33.7533229995577,,
 37,36,36,"US Army Engineer District, Charleston","CESAC",2001,8265,-79.95744399994,32.7940419997394,,
 38,37,37,"US Army Engineer District, Jacksonville","CESAJ",2001,8265,-81.6606230001507,30.318403000399,,