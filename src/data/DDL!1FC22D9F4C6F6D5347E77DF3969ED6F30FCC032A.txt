
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."AV_DISPLAY_UNITS" ("OFFICE_ID", "PARAMETER_ID", "UNIT_SYSTEM", "UNIT_ID") AS 
  SELECT    o.office_id,
                bp.base_parameter_id || SUBSTR ('-', 1, LENGTH (p.sub_parameter_id)) || p.sub_parameter_id AS parameter_id,
                d.unit_system, u.unit_id
      FROM    at_display_units d,
                cwms_office o,
                at_parameter p,
                cwms_base_parameter bp,
                cwms_unit u
     WHERE         o.office_code = d.db_office_code
                AND p.parameter_code = d.parameter_code
                AND bp.base_parameter_code = p.base_parameter_code
                AND u.unit_code = display_unit_code
 
  GRANT SELECT ON "CWMS_20"."AV_DISPLAY_UNITS" TO "CWMS_USER"
 