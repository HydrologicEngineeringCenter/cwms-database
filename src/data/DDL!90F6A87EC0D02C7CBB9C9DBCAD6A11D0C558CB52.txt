
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."AV_PROJECT" ("OFFICE_ID", "PROJECT_ID", "FEDERAL_COST", "NONFEDERAL_COST", "AUTHORIZING_LAW", "PROJECT_OWNER", "HYDROPOWER_DESCRIPTION", "SEDIMENTATION_DESCRIPTION", "DOWNSTREAM_URBAN_DESCRIPTION", "BANK_FULL_CAPACITY_DESCRIPTION", "PUMP_BACK_LOCATION_ID", "NEAR_GAGE_LOCATION_ID", "YIELD_TIME_FRAME_START", "YIELD_TIME_FRAME_END", "PROJECT_REMARKS") AS 
  select project.office_id,
       project.location_id as project_id,
       project.federal_cost,
       project.nonfederal_cost,authorizing_law,
       project.project_owner,
       project.hydropower_description,
       project.sedimentation_description,
       project.downstream_urban_description,
       project.bank_full_capacity_description,
       pumpback.location_id as pump_back_location_id,
       neargage.location_id as near_gage_location_id,
       project.yield_time_frame_start,
       project.yield_time_frame_end,
       project.project_remarks
  from ( select o.office_id as office_id,
                bl.base_location_id
                ||substr('-', 1, length(pl.sub_location_id))
                ||pl.sub_location_id as location_id,
                p.federal_cost,
                p.nonfederal_cost,authorizing_law,
                p.project_owner,
                p.hydropower_description,
                p.sedimentation_description,
                p.downstream_urban_description,
                p.bank_full_capacity_description,
                p.pump_back_location_code,
                p.near_gage_location_code,
                p.yield_time_frame_start,
                p.yield_time_frame_end,
                p.project_remarks
           from cwms_office o,
                at_base_location bl,
                at_physical_location pl,
                at_project p
          where bl.db_office_code = o.office_code
            and pl.base_location_code = bl.base_location_code
            and p.project_location_code = pl.location_code
       ) project
       left outer join
       ( select pl.location_code,
                bl.base_location_id
                ||substr('-', 1, length(pl.sub_location_id))
                ||pl.sub_location_id as location_id
           from at_base_location bl,
                at_physical_location pl,
                at_project p
          where pl.base_location_code = bl.base_location_code
            and p.project_location_code = pl.location_code
       ) pumpback on pumpback.location_code = project.pump_back_location_code
       left outer join
       ( select pl.location_code,
                bl.base_location_id
                ||substr('-', 1, length(pl.sub_location_id))
                ||pl.sub_location_id as location_id
           from at_base_location bl,
                at_physical_location pl,
                at_project p
          where pl.base_location_code = bl.base_location_code
            and p.project_location_code = pl.location_code
       ) neargage on neargage.location_code = project.near_gage_location_code
 
  GRANT SELECT ON "CWMS_20"."AV_PROJECT" TO "CWMS_USER"
 