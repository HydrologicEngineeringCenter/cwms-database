
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."AV_RATING" ("RATING_CODE", "PARENT_RATING_CODE", "OFFICE_ID", "RATING_ID", "LOCATION_ID", "TEMPLATE_ID", "VERSION", "NATIVE_UNITS", "EFFECTIVE_DATE", "CREATE_DATE", "ACTIVE_FLAG", "FORMULA", "DESCRIPTION") AS 
  SELECT    r.rating_code, r.ref_rating_code AS parent_rating_code,
                o.office_id,
                bl.base_location_id || SUBSTR ('-', 1, LENGTH (pl.sub_location_id)) || pl.sub_location_id || '.' || rt.parameters_id || '.' || rt.version || '.' || rs.version AS rating_id,
                bl.base_location_id || SUBSTR ('-', 1, LENGTH (pl.sub_location_id)) || pl.sub_location_id AS location_id,
                rt.parameters_id || '.' || rt.version AS template_id, rs.version,
                r.native_units, r.effective_date, r.create_date, r.active_flag,
                r.formula, r.description
      FROM    at_rating r,
                at_rating_spec rs,
                at_rating_template rt,
                at_physical_location pl,
                at_base_location bl,
                cwms_office o
     WHERE         rs.rating_spec_code = r.rating_spec_code
                AND rt.template_code = rs.template_code
                AND pl.location_code = rs.location_code
                AND bl.base_location_code = pl.base_location_code
                AND o.office_code = bl.db_office_code
 
  GRANT SELECT ON "CWMS_20"."AV_RATING" TO "CWMS_USER"
 