
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."AV_LOC" ("LOCATION_CODE", "BASE_LOCATION_CODE", "DB_OFFICE_ID", "BASE_LOCATION_ID", "SUB_LOCATION_ID", "LOCATION_ID", "LOCATION_TYPE", "UNIT_SYSTEM", "ELEVATION", "UNIT_ID", "VERTICAL_DATUM", "LONGITUDE", "LATITUDE", "HORIZONTAL_DATUM", "TIME_ZONE_NAME", "COUNTY_NAME", "STATE_INITIAL", "PUBLIC_NAME", "LONG_NAME", "DESCRIPTION", "BASE_LOC_ACTIVE_FLAG", "LOC_ACTIVE_FLAG", "LOCATION_KIND_ID", "MAP_LABEL", "PUBLISHED_LATITUDE", "PUBLISHED_LONGITUDE", "BOUNDING_OFFICE_ID", "NATION_ID", "NEAREST_CITY") AS 
  SELECT    location_code, base_location_code, db_office_id, base_location_id,
                sub_location_id, location_id, location_type, unit_system,
                (elevation * factor + offset) elevation, to_unit_id unit_id,
                vertical_datum, longitude, latitude, horizontal_datum,
                time_zone_name, county_name, state_initial, public_name,
                long_name, description, base_loc_active_flag, loc_active_flag,
                location_kind_id, map_label, published_latitude,
                published_longitude, bounding_office_id, nation_id, nearest_city
      FROM        (SELECT     c.office_code db_office_code, location_code,
                                 base_location_code, c.office_id db_office_id,
                                 base_location_id, sub_location_id,
                                 base_location_id || SUBSTR ('-', 1, LENGTH (sub_location_id)) || sub_location_id location_id,
                                 location_type, elevation, vertical_datum, longitude,
                                 latitude, horizontal_datum, time_zone_name,
                                 county_name, state_initial, a.public_name,
                                 a.long_name, a.description,
                                 b.active_flag base_loc_active_flag,
                                 a.active_flag loc_active_flag, location_kind_id,
                                 map_label, published_latitude, published_longitude,
                                 d.office_id bounding_office_id, nation_id,
                                 nearest_city
                        FROM         (   (    (     (   (    (     (   at_physical_location a
                                                                      LEFT OUTER JOIN
                                                                          cwms_office d
                                                                      USING (office_code))
                                                                 JOIN
                                                                     at_base_location b
                                                                 USING (base_location_code))
                                                            JOIN
                                                                cwms_office c
                                                            ON b.db_office_code =
                                                                    c.office_code)
                                                      LEFT OUTER JOIN
                                                          at_location_kind
                                                      ON location_kind =
                                                              location_kind_code)
                                                 LEFT OUTER JOIN
                                                     cwms_time_zone
                                                 USING (time_zone_code))
                                            LEFT OUTER JOIN
                                                cwms_county
                                            USING (county_code))
                                      LEFT OUTER JOIN
                                          cwms_state
                                      USING (state_code))
                                 LEFT OUTER JOIN
                                     cwms_nation
                                 USING (nation_code)
                      WHERE     location_code != 0) aa
                NATURAL JOIN
                    (SELECT     adu.db_office_code, adu.unit_system, cuc.to_unit_id,
                                 factor, offset
                        FROM     at_display_units adu, cwms_unit_conversion cuc
                      WHERE          adu.parameter_code = 10
                                 AND adu.display_unit_code = cuc.to_unit_code
                                 AND cuc.from_unit_code = 39) bb
 
  GRANT SELECT ON "CWMS_20"."AV_LOC" TO "CWMS_USER"
 