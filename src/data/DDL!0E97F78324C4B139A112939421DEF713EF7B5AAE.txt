
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."ZAV_CWMS_TS_ID" ("DB_OFFICE_CODE", "BASE_LOCATION_CODE", "BASE_LOC_ACTIVE_FLAG", "LOCATION_CODE", "LOC_ACTIVE_FLAG", "PARAMETER_CODE", "TS_CODE", "TS_ACTIVE_FLAG", "NET_TS_ACTIVE_FLAG", "DB_OFFICE_ID", "CWMS_TS_ID", "UNIT_ID", "ABSTRACT_PARAM_ID", "BASE_LOCATION_ID", "SUB_LOCATION_ID", "LOCATION_ID", "BASE_PARAMETER_ID", "SUB_PARAMETER_ID", "PARAMETER_ID", "PARAMETER_TYPE_ID", "INTERVAL_ID", "DURATION_ID", "VERSION_ID", "INTERVAL", "INTERVAL_UTC_OFFSET", "VERSION_FLAG") AS 
  SELECT    abl.db_office_code, base_location_code,
                abl.active_flag base_loc_active_flag, location_code,
                l.active_flag loc_active_flag, parameter_code, s.ts_code,
                s.active_flag ts_active_flag,
                CASE WHEN abl.active_flag = 'T' AND l.active_flag = 'T' AND s.active_flag = 'T' THEN 'T' ELSE 'F' END net_ts_active_flag,
                o.office_id db_office_id,
                abl.base_location_id || SUBSTR ('-', 1, LENGTH (l.sub_location_id)) || l.sub_location_id || '.' || base_parameter_id || SUBSTR ('-', 1, LENGTH (ap.sub_parameter_id)) || ap.sub_parameter_id || '.' || parameter_type_id || '.' || interval_id || '.' || duration_id || '.' || version cwms_ts_id,
                u.unit_id, cap.abstract_param_id, abl.base_location_id,
                l.sub_location_id,
                abl.base_location_id || SUBSTR ('-', 1, LENGTH (l.sub_location_id)) || l.sub_location_id location_id,
                base_parameter_id, ap.sub_parameter_id,
                base_parameter_id || SUBSTR ('-', 1, LENGTH (ap.sub_parameter_id)) || ap.sub_parameter_id parameter_id,
                parameter_type_id, interval_id, duration_id, version version_id,
                i.interval, s.interval_utc_offset, s.version_flag
      FROM    at_cwms_ts_spec s
                JOIN at_physical_location l
                    USING (location_code)
                JOIN at_base_location abl
                    USING (base_location_code)
                JOIN cwms_office o
                    ON (abl.db_office_code = o.office_code)
                JOIN at_parameter ap
                    USING (parameter_code)
                JOIN cwms_base_parameter p
                    USING (base_parameter_code)
                JOIN cwms_unit u
                    USING (unit_code)
                JOIN cwms_abstract_parameter cap
                    ON (cap.abstract_param_code = u.abstract_param_code)
                JOIN cwms_parameter_type t
                    USING (parameter_type_code)
                JOIN cwms_interval i
                    USING (interval_code)
                JOIN cwms_duration d
                    USING (duration_code)
     WHERE    s.delete_date IS NULL
 