
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."AV_RATING_LOCAL" ("RATING_CODE", "PARENT_RATING_CODE", "OFFICE_ID", "RATING_ID", "LOCATION_ID", "TEMPLATE_ID", "VERSION", "NATIVE_UNITS", "EFFECTIVE_DATE", "CREATE_DATE", "ACTIVE_FLAG", "FORMULA", "DESCRIPTION") AS 
  SELECT    r.rating_code, r.ref_rating_code AS parent_rating_code,
                o.office_id,
                bl.base_location_id || SUBSTR ('-', 1, LENGTH (pl.sub_location_id)) || pl.sub_location_id || '.' || rt.parameters_id || '.' || rt.version || '.' || rs.version AS rating_id,
                bl.base_location_id || SUBSTR ('-', 1, LENGTH (pl.sub_location_id)) || pl.sub_location_id AS location_id,
                rt.parameters_id || '.' || rt.version AS template_id, rs.version,
                r.native_units,
                cwms_util.change_timezone (r.effective_date, 'UTC', tz.time_zone_name) AS effective_date,
                cwms_util.change_timezone (r.create_date, 'UTC', tz.time_zone_name) AS create_date,
                r.active_flag, r.formula, r.description
      FROM    at_rating r,
                at_rating_spec rs,
                at_rating_template rt,
                at_physical_location pl,
                at_base_location bl,
                cwms_office o,
                cwms_time_zone tz
     WHERE         rs.rating_spec_code = r.rating_spec_code
                AND rt.template_code = rs.template_code
                AND pl.location_code = rs.location_code
                AND bl.base_location_code = pl.base_location_code
                AND o.office_code = bl.db_office_code
                AND tz.time_zone_code = NVL (pl.time_zone_code, 0)
 
  GRANT SELECT ON "CWMS_20"."AV_RATING_LOCAL" TO "CWMS_USER"
 