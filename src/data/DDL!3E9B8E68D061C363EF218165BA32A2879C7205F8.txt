
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."AV_TS_GRP_ASSGN" ("CATEGORY_ID", "GROUP_ID", "TS_CODE", "DB_OFFICE_ID", "TS_ID", "ALIAS_ID", "ATTRIBUTE", "REF_TS_ID", "SHARED_ALIAS_ID", "SHARED_REF_TS_ID") AS 
  SELECT	atc.ts_category_id, atg.ts_group_id, atga.ts_code,
				co.office_id AS db_office_id,
				cwms_ts.get_cwms_ts_id (acts.ts_code, co.office_id) AS ts_id,
				atga.ts_alias_id, atga.ts_attribute,
				cwms_ts.get_cwms_ts_id (acts2.ts_code, co.office_id) AS ref_ts_id,
				atg.shared_ts_alias_id,
				cwms_ts.get_cwms_ts_id (acts3.ts_code, co.office_id) AS shared_ref_ts_id
	  FROM	at_cwms_ts_spec acts,
				at_ts_group_assignment atga,
				at_ts_group atg,
				at_ts_category atc,
				at_physical_location pl,
				at_base_location bl,
				cwms_office co,
				at_cwms_ts_spec acts2,
				at_cwms_ts_spec acts3
	 WHERE		 pl.location_code = acts.location_code
				AND bl.base_location_code = pl.base_location_code
				AND co.office_code = bl.db_office_code
				AND atga.ts_code = acts.ts_code
				AND atga.ts_group_code = atg.ts_group_code
				AND atg.ts_category_code = atc.ts_category_code
				AND acts2.ts_code(+) = atga.ts_ref_code
				AND acts3.ts_code(+) = atg.shared_ts_ref_code
 
  GRANT SELECT ON "CWMS_20"."AV_TS_GRP_ASSGN" TO "CWMS_USER"
 