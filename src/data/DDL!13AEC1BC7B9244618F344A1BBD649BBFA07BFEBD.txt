
  CREATE OR REPLACE FORCE VIEW "CWMS_20"."AV_GATE_CHANGE" ("GATE_CHANGE_CODE", "OFFICE_ID", "PROJECT_ID", "GATE_CHANGE_DATE", "TIME_ZONE", "ELEV_POOL_EN", "ELEV_TAILWATER_EN", "ELEV_UNIT_EN", "ELEV_POOL_SI", "ELEV_TAILWATER_SI", "ELEV_UNIT_SI", "OLD_DISCHARGE_OVERRIDE_EN", "NEW_DISCHARGE_OVERRIDE_EN", "DISCHARGE_UNIT_EN", "OLD_DISCHARG_OVERRIDE_SI", "NEW_DISCHARGE_OVERRIDE_SI", "DISCHARGE_UNIT_SI", "DISCHARGE_COMP", "DISCHARGE_COMP_DESCR", "RELEASE_REASON", "RELEASE_REASON_DESCR", "GATE_CHANGE_NOTES", "PROTECTED") AS 
  select gc.gate_change_code,
       o.office_id as office_id,
       bl.base_location_id
       ||substr('-', 1, length(pl.sub_location_id))
       ||pl.sub_location_id as project_id,
       cwms_util.change_timezone(
          gc.gate_change_date,
          'UTC',
          cwms_loc.get_local_timezone(gc.project_location_code)) as gate_change_date,
       cwms_loc.get_local_timezone(gc.project_location_code) as time_zone,
       cwms_rounding.round_dd_f(
          cwms_util.convert_units(gc.elev_pool, 'm', 'ft'),
          '9999999999') as elev_pool_en,
       cwms_rounding.round_dd_f(
          cwms_util.convert_units(gc.elev_tailwater, 'm', 'ft'),
          '9999999999') as elev_tailwater_en,
       'ft' as elev_unit_en,
       cwms_rounding.round_dd_f(gc.elev_pool, '9999999999') as elev_pool_si,
       cwms_rounding.round_dd_f(gc.elev_tailwater, '9999999999') as elev_tailwater_si,
       'm' as elev_unit_si,
       cwms_rounding.round_dd_f(
          cwms_util.convert_units(gc.old_total_discharge_override, 'cms', 'cfs'),
          '9999999999') as old_discharge_override_en,
       cwms_rounding.round_dd_f(
          cwms_util.convert_units(gc.new_total_discharge_override, 'cms', 'cfs'),
          '9999999999') as new_discharge_override_en,
       'cfs' as discharge_unit_en,
       cwms_rounding.round_dd_f(
          gc.old_total_discharge_override,
          '9999999999') as old_discharg_override_si,
       cwms_rounding.round_dd_f(
          gc.new_total_discharge_override,
          '9999999999') as new_discharge_override_si,
       'cms' as discharge_unit_si,
       gcc.discharge_comp_display_value as discharge_comp,
       gcc.discharge_comp_tooltip as discharge_comp_descr,
       grr.release_reason_display_value as release_reason,
       grr.release_reason_tooltip as release_reason_descr,
       gc.gate_change_notes,
       gc.protected
  from cwms_office o,
       at_base_location bl,
       at_physical_location pl,
       at_gate_change gc,
       at_gate_ch_computation_code gcc,
       at_gate_release_reason_code grr
 where bl.db_office_code = o.office_code
   and pl.base_location_code = bl.base_location_code
   and gc.project_location_code = pl.location_code
   and gcc.discharge_comp_code = gc.discharge_computation_code
   and grr.release_reason_code = gc.release_reason_code
 
  GRANT SELECT ON "CWMS_20"."AV_GATE_CHANGE" TO "CWMS_USER"
 