CREATE OR REPLACE PACKAGE extended_datatype_support wrapped 
a000000
1
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
9
41e6 90b
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

/
create table eds_supported_tables (
  owner      VARCHAR2(30),
  table_name VARCHAR2(30)
);
alter table eds_supported_tables 
add constraint st_pk primary key(owner, table_name);
create table eds_dml_triggers(
  owner         VARCHAR2(30),
  table_name    VARCHAR2(30),
  trigger_name  VARCHAR2(30),
  creation_time DATE DEFAULT sysdate
);
alter table eds_dml_triggers 
add constraint dt_pk primary key(owner, table_name, trigger_name);
create table eds_shadow_tables(
  owner             VARCHAR2(30),
  base_table_name   VARCHAR2(30),
  shadow_table_name VARCHAR2(30),
  creation_time DATE DEFAULT sysdate
);
alter table eds_shadow_tables 
add constraint sht_pk primary key(owner, base_table_name, shadow_table_name);
create table eds_dml_handlers (
  handler_owner  VARCHAR2(30),
  handler_name   VARCHAR2(30),
  table_owner    VARCHAR2(30),
  table_name     VARCHAR2(30), 
  creation_time DATE DEFAULT sysdate
);
alter table eds_dml_handlers 
add constraint dh_pk primary key(handler_owner, handler_name);
create table eds_materialized_views (
  owner         VARCHAR2(30),
  table_name    VARCHAR2(30),
  mview_name    VARCHAR2(30), 
  creation_time DATE DEFAULT sysdate
);
alter table eds_materialized_views
add constraint mv_pk primary key(owner, table_name, mview_name);
create table eds_table_rules (
  rule_name      VARCHAR2(65),
  type           VARCHAR2(30),
  ruleset_owner  VARCHAR2(30),
  ruleset_name   VARCHAR2(30),
  table_owner    VARCHAR2(30),
  table_name     VARCHAR2(30),
  streams_type   VARCHAR2(30),
  streams_name   VARCHAR2(30),
  include_dml    VARCHAR2(30),
  include_ddl    VARCHAR2(30),
  inclusion_rule VARCHAR2(30),
  creation_time  DATE DEFAULT sysdate
);
alter table eds_table_rules
add constraint tr_pk primary key(rule_name, ruleset_owner, ruleset_name);
create table eds_script_names (
  script_name    VARCHAR2(30),
  user_name      VARCHAR2(30),
  directory_path VARCHAR2(4000),
  comments       VARCHAR2(4000),
  create_time    DATE DEFAULT sysdate
);
alter table eds_script_names
add constraint sn_pk primary key(script_name);
CREATE OR REPLACE VIEW EDS_SUPPORTED
(OWNER, TABLE_NAME, TABLESPACE_NAME)
AS
SELECT distinct u1.name, o1.name, ts1.name
  FROM  sys.user$ u1, sys.obj$ o1,
        sys.tab$ t1, sys.col$ c1, sys.ts$ ts1
  WHERE  u1.user# = o1.owner#
   AND  o1.obj#  = t1.obj#
   AND  o1.obj#  = c1.obj#
   AND  t1.ts# = ts1.ts#
   AND  u1.name NOT IN ('ODM', 'SI_INFORMTN_SCHEMA', 'ORDPLUGINS',
                        'OUTLN', 'DBSNMP', 'DIP', 'SYS', 'SYSTEM',
                        'ANONYMOUS', 'BI', 'MDDATA', 'MGMT_VIEW',
                        'SYSMAN', 'WKPROXY', 'WKSYS', 'WK_TEST',
                        'TSMSYS', 'EXFSYS', 'CTXSYS', 'DMSYS',
                        'MDSYS', 'OLAPSYS', 'ORDSYS', 'WMSYS', 'XDB')
   AND  bitand(t1.property, 
                            1                               /* object table */
                          + 2                                /* ADT columns */
                          + 16                             /* array columns */
                 ) <> 0
   AND  (u1.name, o1.name) IN
     (select owner, table_name from dba_streams_unsupported)
   AND  (u1.name, o1.name) NOT IN
     (
          SELECT distinct u.name, o.name
          FROM   sys.user$ u, sys.obj$ o, sys.tab$ t, sys.col$ c
          WHERE  u.user# = o.owner#
            AND  o.obj#  = t.obj#
            AND  o.obj#  = c.obj#
            AND  u.name NOT IN ('ODM', 'SI_INFORMTN_SCHEMA', 'ORDPLUGINS',
                                'OUTLN', 'DBSNMP', 'DIP', 'SYS', 'SYSTEM',
                                'ANONYMOUS', 'BI', 'MDDATA', 'MGMT_VIEW',
                                'SYSMAN', 'WKPROXY', 'WKSYS', 'WK_TEST',
                                'TSMSYS', 'EXFSYS', 'CTXSYS', 'DMSYS',
                                'MDSYS', 'OLAPSYS', 'ORDSYS', 'WMSYS', 'XDB')
            AND
            (       
                bitand(t.property,
                            1                               /* object table */
                          + 2                                /* ADT columns */
                          + 16                             /* array columns */
                       ) = 0
             OR bitand(t.property, 
                            8                                /* REF columns */
                          + 4096                                  /* pk OID */
                          + 8192 /* a storage table for nested table column */
                          + 65536                                   /* sOID */
                          + 131072                     /* an AQ queue table */
                      ) <> 0
             OR (bitand (c.property, 4) <> 0 AND    /* nested table columns */
                not exists 
                   (select 1 from sys.col$ c1
                     where c.col# = c1.col#
                       and c.obj# = c1.obj#
                       and c1.type# = 58)
                 )
             OR bitand(o.flags,
                            2                           /* temporary object */
                          + 4                    /* system generated object */
                          + 32                      /* in-memory temp table */
                          + 128               /* dropped table (RecycleBin) */
                          + 32768                           /* FILE columns */
                          + 4194304             /* a global temporary table */
                          + 8388608   /* a session-specific temporary table */
                          + 134217728                       /* a sub object */
                          + 2147483648                 /* an external table */
                      ) <> 0
             OR (bitand(c.property, 1) = 1  and 
                            /* ADT attribute columns can not be Long or Lob */
                     (c.type# NOT IN (
                             1,                                 /* varchar2 */
                             2,                                   /* number */
                             12,                                    /* date */
                             23,                                     /* raw */
                             58,                                     /* XML */
                             96,                                    /* char */
                             100,                           /* binary float */
                             101,                          /* binary double */
                             121,                             /* ADT column */
                             123,                       /* named array type */
                             180,                         /* timestamp (..) */
                             181,           /* timestamp(..) with time zone */
                             182,             /* interval year(..) to month */
                             183,         /* interval day(..) to second(..) */
                             208,                                 /* urowid */
                             231) or  /* timestamp(..) with local time zone */
                                                         /* raw not raw oid */
                    (c.type# = 23 and bitand(c.property, 2) = 2)))
           OR (                  /* if non-attribute column is lob, it must */
                                                        /* have primary key */
                   bitand(c.property, 1) = 0  and 
                   c.type# IN (112, 113) and
                   not exists(                     /* not xml stored as lob */
                     select 1 from sys.col$ c2
                     where  o.obj# = c2.obj#
                       and  c.col# = c2.col#
                       and  c2.type# = 58) and
                   not exists(                    /* no primary key columns */
                     select 1 from sys.cdef$ cd
                     where cd.obj# = o.obj#
                       and cd.type# = 2) and/* no non-nullable unique index */
                   not exists(
                     select 1 from sys.ind$ i, sys.col$ c2
                     where o.obj# = c2.obj#
                       and sign(c2.null$) > 0
                       and i.bo# = o.obj#
                       and bitand(i.property, 1) = 1
                       and i.type# in (1, 2, 3, 4, 6, 7)) and
                                                   /* not an XMLDATA column */
                  not exists(
                     select 1 from sys.col$ c2
                     where c2.obj# = c.obj#
                       and c2.col# = c.col#
                       and c2.intcol# <> c.intcol#
                       and c2.type# = 58
                       and c.name = 'XMLDATA'
                  )
                )
              OR (bitand(c.property, 1) = 0  and                      
                                   /* non-attribute columns can not be Long */
                    (c.type# NOT IN ( 
                             1,                                 /* varchar2 */
                             2,                                   /* number */
                             12,                                    /* date */
                              8,                                    /* long */
                             23,                                     /* raw */
                             58,                                     /* XML */
                             96,                                    /* char */
                             100,                           /* binary float */
                             101,                          /* binary double */
                             112,                         /* clob and nclob */
                             121,                             /* ADT column */
                             123,                       /* named array type */
                             113,                                   /* blob */
                             180,                         /* timestamp (..) */
                             181,           /* timestamp(..) with time zone */
                             182,             /* interval year(..) to month */
                             183,         /* interval day(..) to second(..) */
                             208,                                 /* urowid */
                             231) or  /* timestamp(..) with local time zone */
                                   /* For non-object table, raw not raw oid */
                    (c.type# = 23 and bitand(c.property, 2) = 2
                     and bitand(t.property, 1) = 0)or
                    (c.type# = 8 and u.name<>'HR' and o.name<>'PER_ADDRESSES')))));
create or replace view eds_streams_unsupported
as select owner, table_name, reason, auto_filtered
from dba_streams_unsupported
where (owner, table_name) NOT IN
(  
  select owner, table_name from eds_supported
);
create or replace view EDS_UNSUPPORTED_COLUMNS
  (owner, table_name, column_name, type, reason)
AS
  select owner, table_name, column_name, type, reason
  from
    (select distinct u.name owner, o.name table_name , c.name column_name, 
      decode (c.type#,
            1, 'VARCHAR2',
            2, 'NUMBER',
            8, 'DATE',
            12, 'DATE',
            24, 'LONG RAW',
            23, 'RAW',
            69, 'ROWID',
            96, 'CHAR',
            100, 'BINARY_FLOAT',
            101, 'BINARY_DOUBLE',
            112, 'CLOB',
            113, 'BLOB',
            114, 'BFILE',
            121, 'ADT column',
            122, 'Nested table column',
            123, 'Varray column',
            180, 'TIMESTAMP',
            181, 'TIMESTAMP WITH TIME ZONE',
            182, 'INTERVAL YEAR TO MONTH',
            183, 'INTERVAL DAY TO SECOND',
            208, 'UROWID',
            231, 'TIMESTAMP WITH LOCAL TIME ZONE',
            NULL) type,
                                                                   /* reason */
    (case
      when bitand(t.property, 131072) != 0                      /* AQ table */
        then 'AQ queue table'
       when bitand(t.property, 134217728) != 0                 /* Sub table */
        then 'sub table'
      when bitand(t.property, 2147483648) !=0             /* external table */
        then 'external table'
      when  bitand(t.property, 8192) != 0
        then 'storage table for nested table column'
      when c.type#=122 or bitand(c.property, 4) = 4
      or exists (
        select 1 from sys.col$ c2
        where c2.obj# = c.obj# and
              bitand(c2.property, 32) = 32 and
              c2.type# = 122)
      then 'table with nested table column'
      when c.type#=111 and                                    /* REF colunm */
        not exists(
          select 1 from sys.col$ c2
          where c2.obj# = c.obj#
            and c2.col# = c.col#
            and c2.intcol# <> c.intcol#
            and c2.type# = 58
            and c.name = 'XMLDATA'
        )
        then 'table with REF column'
      when bitand(t.property, 4096) != 0                          /* pk OID */
        then 'table with primary key based oid column'
      when bitand(t.property, 32768) != 0             /* FILE column exists */
        then 'table with FILE column'
      when bitand(t.property, 65536) != 0                           /* sOID */
        then 'table with system generated OID'
      when bitand(c.property, 1) = 0  and c.type# IN (112, 113)
           and not exists(                        /* no promary key columns */
                     select 1 from sys.cdef$ cd
                     where cd.obj# = o.obj#
                       and cd.type# = 2)    /* no non-nullable unique index */
           and not exists(
                     select 1 from sys.ind$ i, sys.col$ c2
                     where o.obj# = c2.obj#
                       and sign(c2.null$) > 0
                       and i.bo# = o.obj#
                       and bitand(i.property, 1) = 1
                       and i.type# in (1, 2, 3, 4, 6, 7))
        then 'LOB+ADT without pkey or non-nullable unique index' 
      when c.type# = 69  then 'rowid column'
      when bitand(c.property, 2) != 0                         /* OID column */
        then 'table with OID column'
      when c.type# = 8 and u.name <> 'HR' and o.name <> 'PER_ADDRESSES'
        then 'long column'
      when c.type# = 121 and               /* ADT attribute column has lobs */
        exists (select 1 from sys.col$ c1
                where c1.obj# = c.obj#
                  and c1.col# = c.col#
                  and bitand(c1.property, 1) = 1
                  and c1.type# IN (112, 113))
        then 'ADT attribute column has lobs'
      when (c.type# = 58 and
        exists (select 1 from sys.opqtype$ op
                where op.obj# = c.obj#
                  and op.intcol# = c.intcol#
                  and bitand(op.flags, 1 + 4 + 64) = 0))
        then 'unsupported opaque type'
      else NULL
     end) reason
  from sys.obj$ o, sys.user$ u, sys.col$ c, sys.tab$ t
  where c.obj# = o.obj# and
        o.obj# = t.obj# and
        o.owner# = u.user# and
        bitand(c.property, 32) = 0 and 
                  /* should be consistent with knlcfIsFilteredSpecialSchema */
        u.name not in ('SYS', 'SYSTEM') and 
        bitand(o.flags,
                  2                                     /* temporary object */
                + 4                              /* system generated object */
                + 32                                /* in-memory temp table */
                + 128                         /* dropped table (RecycleBin) */
                  ) = 0 and
        (
          bitand(t.property, 1                               /* typed table */
                             + 2                   /* table with ADT column */
                             + 4                    /* nested table columns */
                             + 8                             /* REF columns */
                             + 16               /* table with varray column */
                             + 4096                               /* pk OID */
                             + 8192/* storage table for nested table column */
                             + 32768                  /* FILE column exists */
                             + 65536                                /* sOID */
                             + 131072                           /* AQ table */
                             + 134217728                       /* Sub table */
                             + 4194304                        /* temp table */
                             + 8388608                        /* temp table */
                             + 2147483648                 /* external table */
                 ) != 0 or
           bitand(t.trigflag, 268435456) != 0        /* streams unsupported */
        )
    ) where reason IS NOT NULL;
create or replace view eds_unsupported_schemas
 (schema_name)
as select name from sys.user$ where name IN 
  ('ODM', 'SI_INFORMTN_SCHEMA', 'ORDPLUGINS',
   'OUTLN', 'DBSNMP', 'DIP', 'SYS', 'SYSTEM',
   'ANONYMOUS', 'BI', 'MDDATA', 'MGMT_VIEW',
   'SYSMAN', 'WKPROXY', 'WKSYS', 'WK_TEST',
   'TSMSYS', 'EXFSYS', 'CTXSYS', 'DMSYS',
   'MDSYS', 'OLAPSYS', 'ORDSYS', 'WMSYS', 'XDB');
create sequence streams$_eds_fname_seqno
 start with     1
 increment by   1
 nocache
 nocycle
/
create sequence streams$_eds_handler_seqno
 start with     1
 increment by   1
 nocache
 nocycle
/
